Задача 0.4. Порядок перемножения матриц

Имя входного файла: input.txt
Имя выходного файла: output.txt
Ограничение по времени: 1 с
Ограничение по памяти: 256 МБ

Дана последовательность из s матриц A1, A2, …, As. Требуется определить, в каком порядке их следует перемножать, чтобы число атомарных операций умножения было минимальным. Матрицы предполагаются совместимыми по отношению к матричному умножению (т.е. число столбцов матрицы Ai−1 совпадает с числом строк матрицы Ai).

Будем считать, что произведение матриц — операция, которая принимает на вход две матрицы размера k × m и m × n и возвращает матрицу размера k × n, затратив на это kmn атомарных операций умножения. (Базовый тип позволяет хранить любой элемент итоговой и любой возможной промежуточной матрицы, поэтому умножение двух элементов требует одной атомарной операции.)

Так как перемножение матриц ассоциативно, итоговая матрица не зависит от порядка выполнения операций умножения. Другими словами, нет разницы, в каком порядке расставляются скобки между множителями, результат будет один и тот же.

Формат входных данных
В первой строке задано число s матриц (2 ≤ s ≤ 100).
В последующих s строках заданы размеры матриц: строка i + 1 содержит через пробел число ni строк и число mi столбцов матрицы Ai (1 ≤ ni, mi ≤ 100).
Гарантируется, что mi совпадает с ni+1 для всех индексов i от 1 до s − 1.

Формат выходных данных
Выведите минимальное число атомарных операций умножения, необходимое для перемножения s матриц.

Примеры

input.txt:
3
2 3
3 5
5 10

output.txt:
130

input.txt:
4
20 5
5 35
35 4
4 25

output.txt:
3100

Замечание
В первом примере можно умножать двумя способами:
(A1(A2A3)): требуется 3 × 5 × 10 + 2 × 3 × 10 = 150 + 60 = 210 операций;
((A1A2)A3): требуется 2 × 3 × 5 + 2 × 5 × 10 = 30 + 100 = 130 операций.
Второй способ эффективнее.